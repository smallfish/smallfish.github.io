<!DOCTYPE html>

<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>Pysvn 程序员指南 | blog // smallfish</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#FF3DB4">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="/css/main.min.e34415025514319010e741089e6920454053855755ba465f66943ad102d2cb08.css"/>

    
    
    

    
    
 
    </head>

    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="/">blog // smallfish</a>
    </div>  
</header>

  <div class="nav-menu">
  
    <a class="color-link nav-link" href="/about/">About</a>
  
    <a class="color-link nav-link" href="/tags/">Tags</a>
  
    <a class="color-link nav-link" href="/archives/">Archives</a>
  
  <a class="color-link nav-link" href="/index.xml" target="_blank" rel="noopener" type="application/rss+xml">RSS</a>
</div>
<footer class="footer">
	<div class="social-icons">
        

    

    
    <a class="social-icon" href="https://twitter.com/smallfishxy" target="_blank" rel="noopener" title="Twitter">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M8.991284,24.971612 C19.180436,24.971612 24.752372,16.530224 24.752372,9.210524 C24.752372,8.970656 24.747512,8.731868 24.736496,8.494376 C25.818008,7.712564 26.758256,6.737 27.5,5.62622 C26.507372,6.067076 25.439252,6.364292 24.318752,6.498212 C25.462472,5.812628 26.340512,4.727444 26.754584,3.434036 C25.684088,4.068536 24.499004,4.53002 23.23724,4.778528 C22.226468,3.701876 20.786828,3.028388 19.193828,3.028388 C16.134404,3.028388 13.653536,5.509256 13.653536,8.567492 C13.653536,9.0023 13.702244,9.424904 13.797176,9.830552 C9.19346,9.599108 5.11106,7.39472 2.3792,4.04294 C1.903028,4.861364 1.629032,5.812628 1.629032,6.827072 C1.629032,8.74904 2.606972,10.445612 4.094024,11.438132 C3.185528,11.41016 2.331788,11.160464 1.585184,10.745096 C1.583888,10.768208 1.583888,10.791428 1.583888,10.815728 C1.583888,13.49888 3.493652,15.738584 6.028088,16.246508 C5.562932,16.373084 5.07326,16.44134 4.56782,16.44134 C4.210988,16.44134 3.863876,16.406024 3.526484,16.34144 C4.231724,18.542264 6.276596,20.143796 8.701412,20.18894 C6.805148,21.674696 4.416836,22.56008 1.821488,22.56008 C1.374476,22.56008 0.93362,22.534592 0.5,22.4834 C2.951708,24.054476 5.862524,24.971612 8.991284,24.971612"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/smallfish" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

    

    

    

</div>




    <p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
    <p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>

	<script src="/js/main.min.a7205ef73b078c8daed6fe1b0826e8ba229ffabbb69d299d9446cf41f2c7d8aa.js" integrity="sha256-pyBe9zsHjI2u1v4bCCbouiKf+ru2nSmdlEbPQfLH2Ko=" crossorigin="anonymous"></script>
</footer>

</nav>

        <div id="content" class="content-container">
        

<h1 class="post-title">Pysvn 程序员指南</h1>
    
    <time>2009-11-20</time>
    
    <div>
        <p>
        <p>这是一篇关于pysvn模块的指南.</p>
<p>完整和详细的API请参考 <a href="http://pysvn.tigris.org/docs/pysvn_prog_ref.html">http://pysvn.tigris.org/docs/pysvn_prog_ref.html</a>.</p>
<p>pysvn是操作Subversion版本控制的Python接口模块. 这个API接口可以管理一个工作副本, 查询档案库, 和同步两个.</p>
<p>该API不能创建新的仓库; 只能作用在现有仓库上. 如果你需要创建一个仓库, 请使用Subversion的svnadmin命令.</p>
<p>使用这个API, 你可以check out一份工作拷贝, 添加, 编辑, 和删除工作文件, 和check in, 比较, 或者放弃更改. 仓库属性, 如关键字扩展, 行字符结束, 或者忽略的列表也可以检查和控制.</p>
<p>Subversion 模型</p>
<p>Subversion是一个更新-编辑-提交的模型. 首先在本地建立一个工作副本. 在工作副本上进行修改, 最后提交到中央仓库 (可以是本地或者远程).</p>
<p>这个模型允许多人偶尔会同时修改同一个文件. 大多情况下. Subversion不会干预合并这些不同修改, 如果一个提交失败, 用户或者应用则要重新检查和修改然后再次提交.</p>
<p>常见任务</p>
<p>本节给出一些使用pysvn接口的常用例子. 业务可以会递归的处理目录. 添加参数recurse=False以防止这种行为; 例如, 你可以需要添加内容没有增加一个目录.</p>
<p>check out一份工作副本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#check out the current version of the pysvn project</span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>checkout(<span style="color:#e6db74">&#39;http://localhost/example/trunk&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;./examples/pysvn&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#check out revision 11 of the pysvn project</span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>checkout(<span style="color:#e6db74">&#39;http://localhost/example/trunk&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#e6db74">&#39;./examples/pysvn-11&#39;</span>,
</span></span><span style="display:flex;"><span>   revision<span style="color:#f92672">=</span>pysvn<span style="color:#f92672">.</span>Revision(pysvn<span style="color:#f92672">.</span>opt_revision_kind<span style="color:#f92672">.</span>number, <span style="color:#ae81ff">11</span>))</span></span></code></pre></div>
<p>这是一个建立example测试项目的例子，目录是examples/pysvn. 这个项目是用在剩下的例子.</p>
<p>添加一个文件或者目录到仓库</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span><span style="color:#75715e"># write a file foo.txt</span>
</span></span><span style="display:flex;"><span>f <span style="color:#f92672">=</span> file(<span style="color:#e6db74">&#39;./examples/pysvn/foo.txt&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#39;Sample versioned file via pithon</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#schedule the addition;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  the working copy will now track the file as a scheduled change</span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>add(<span style="color:#e6db74">&#39;./examples/pysvn/foo.txt&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#committing the change actually adds the file to the repository</span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>checkin([<span style="color:#e6db74">&#39;./examples/pysvn/foo.txt&#39;</span>], <span style="color:#e6db74">&#39;Adding a sample file&#39;</span>)</span></span></code></pre></div>
<p>这个例子是在工作副本中创建了&rsquo;foo.txt&rsquo;文件, 然后添加到仓库. 请注意Client.import_()命令会同时增加和提交. 大多数应用, 会在许多修改后再提交.</p>
<p>更新工作副本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>update(<span style="color:#e6db74">&#39;./examples/pysvn&#39;</span>)</span></span></code></pre></div>
<p>从仓库中更新其他用户修改并保存到本地副本. 大多数应用应该经常这样做以防止冲突.</p>
<p>提交更新到仓库</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span><span style="color:#75715e"># edit the file foo.txt</span>
</span></span><span style="display:flex;"><span>f <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;./examples/pysvn/foo.txt&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#39;Sample versioned file via python</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># checkin the change with a log message</span>
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>checkin([<span style="color:#e6db74">&#39;./examples/pysvn&#39;</span>], <span style="color:#e6db74">&#39;Corrected spelling of python in foo.txt&#39;</span>)</span></span></code></pre></div>
<p>提交到Subversion是原子的. 要么所有修改都成功提交, 要么提交失败. 大部分应用会提交工作副本所有修改, 如本例所示, 或者通过个别文件或者目录, 但必须是同一单位.</p>
<p>放弃工作副本修改</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span><span style="color:#75715e"># edit the file foo.txt</span>
</span></span><span style="display:flex;"><span>f <span style="color:#f92672">=</span> file(<span style="color:#e6db74">&#39;./examples/pysvn/foo.txt&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#39;This change will never be seen</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#discard the edits</span>
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>revert(<span style="color:#e6db74">&#39;./examples/pysvn/foo.txt&#39;</span>)</span></span></code></pre></div>
<p>这丢弃在工作拷贝和恢复的文件或目录的任何未提交的未经编辑的状态变化.</p>
<p>正在计划增加或移除留无版本或恢复到工作拷贝.</p>
<p>重命名或者移动文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#rename the file client side</span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>move(<span style="color:#e6db74">&#39;./examples/pysvn/foo.txt&#39;</span>, <span style="color:#e6db74">&#39;./examples/pysvn/foo2.txt&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#checkin the change removes the file from the repository</span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>checkin([<span style="color:#e6db74">&#39;./examples/pysvn/foo.txt&#39;</span>, <span style="color:#e6db74">&#39;./examples/pysvn/foo2.txt&#39;</span>], <span style="color:#e6db74">&#39;Foo has become Foo2&#39;</span>)</span></span></code></pre></div>
<p>移动或重命名文件删除旧路径或名称的文件, 并增加了在新的位置, 同时保留以前的版本有关的信息.</p>
<p>在这个例子里, 我们通过文件名Client.checkin()传递父目录也将是有效的.</p>
<p>转移和合并可以在服务器端单步完成; 可以参见仓库任务的那节例子.</p>
<p>从仓库中删除文件或目录</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#schedule the removal;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  the file will be removed from the working copy</span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#39;./examples/pysvn/foo2.txt&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#committing the change removes the file from the repository</span>
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>checkin([<span style="color:#e6db74">&#39;./examples/pysvn/foo2.txt&#39;</span>], <span style="color:#e6db74">&#39;Removing sample file&#39;</span>)</span></span></code></pre></div>
<p>有些人把删除的文件, 或是用完全清除存储库目录. 该文件仍然存在于以前的版本, 可以通过检查或以其他方式进行审查以前修订的内容检索.</p>
<p>确定等待变动</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>changes <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>status(<span style="color:#e6db74">&#39;./examples/pysvn&#39;</span>)
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#39;files to be added:&#39;</span>
</span></span><span style="display:flex;"><span>print [f<span style="color:#f92672">.</span>path <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> changes <span style="color:#66d9ef">if</span> f<span style="color:#f92672">.</span>text_status <span style="color:#f92672">==</span> pysvn<span style="color:#f92672">.</span>wc_status_kind<span style="color:#f92672">.</span>added]
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#39;files to be removed:&#39;</span>
</span></span><span style="display:flex;"><span>print [f<span style="color:#f92672">.</span>path <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> changes <span style="color:#66d9ef">if</span> f<span style="color:#f92672">.</span>text_status <span style="color:#f92672">==</span> pysvn<span style="color:#f92672">.</span>wc_status_kind<span style="color:#f92672">.</span>deleted]
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#39;files that have changed:&#39;</span>
</span></span><span style="display:flex;"><span>print [f<span style="color:#f92672">.</span>path <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> changes <span style="color:#66d9ef">if</span> f<span style="color:#f92672">.</span>text_status <span style="color:#f92672">==</span> pysvn<span style="color:#f92672">.</span>wc_status_kind<span style="color:#f92672">.</span>modified]
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#39;files with merge conflicts:&#39;</span>
</span></span><span style="display:flex;"><span>print [f<span style="color:#f92672">.</span>path <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> changes <span style="color:#66d9ef">if</span> f<span style="color:#f92672">.</span>text_status <span style="color:#f92672">==</span> pysvn<span style="color:#f92672">.</span>wc_status_kind<span style="color:#f92672">.</span>conflicted]
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#39;unversioned files:&#39;</span>
</span></span><span style="display:flex;"><span>print [f<span style="color:#f92672">.</span>path <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> changes <span style="color:#66d9ef">if</span> f<span style="color:#f92672">.</span>text_status <span style="color:#f92672">==</span> pysvn<span style="color:#f92672">.</span>wc_status_kind<span style="color:#f92672">.</span>unversioned]</span></span></code></pre></div>
<p>生成差异或补丁</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>diff_text <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>diff(<span style="color:#e6db74">&#39;./tmp-file-prefix-&#39;</span>, <span style="color:#e6db74">&#39;.&#39;</span>)</span></span></code></pre></div>
<p>获取仓库URL</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>entry <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;.&#39;</span>)
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#39;Url:&#39;</span>,entry<span style="color:#f92672">.</span>url</span></span></code></pre></div>
<p>仓库任务</p>
<p>本节说明任务的例子, 操纵或检查仓库.虽然共同任务, 通过本地工作副本时间的变化, 这些任务直接影响到库
获取仓库目录的清单</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>entry_list <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>ls(<span style="color:#e6db74">&#39;.&#39;</span>)</span></span></code></pre></div>
<p>从仓库获取文件内容</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>file_content <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>cat(<span style="color:#e6db74">&#39;file.txt&#39;</span>)</span></span></code></pre></div>
<p>创建一个标记或分支</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>log_message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;reason for change&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_log_message</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>, log_message
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>callback_get_log_message <span style="color:#f92672">=</span> get_log_message
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>copy(<span style="color:#e6db74">&#39;http://svnrepo.com/svn/trunk&#39;</span>, <span style="color:#e6db74">&#39;http://svnrepo.com/svn/tag/</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> tag_name )</span></span></code></pre></div>
<p>从仓库中转移或者重命名</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>move( <span style="color:#e6db74">&#39;file_old.txt&#39;</span>, <span style="color:#e6db74">&#39;file_new.txt&#39;</span> )</span></span></code></pre></div>
<p>锁定文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>lock( <span style="color:#e6db74">&#39;file.txt&#39;</span>, <span style="color:#e6db74">&#39;reason for locking&#39;</span> )</span></span></code></pre></div>
<p>锁定文件并锁定其他用户或者工作副本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>lock( <span style="color:#e6db74">&#39;file.txt&#39;</span>, <span style="color:#e6db74">&#39;reason for locking&#39;</span>, force<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span> )</span></span></code></pre></div>
<p>解锁</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>unlock( <span style="color:#e6db74">&#39;file.txt&#39;</span> )</span></span></code></pre></div>
<p>解锁文件并锁定其他用户或工作副本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pysvn
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pysvn<span style="color:#f92672">.</span>Client()
</span></span><span style="display:flex;"><span>client<span style="color:#f92672">.</span>unlock( <span style="color:#e6db74">&#39;file.txt&#39;</span>, force<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span> )</span></span></code></pre></div>
<p>测试锁定文件</p>
<p>Method 1:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>all_entries <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>info2( path, recurse<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span> )
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> path, info <span style="color:#f92672">in</span> all_entries:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> info[<span style="color:#e6db74">&#39;lock&#39;</span>]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> info[<span style="color:#e6db74">&#39;lock&#39;</span>][<span style="color:#e6db74">&#39;token&#39;</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;&#39;</span>:
</span></span><span style="display:flex;"><span>            print <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> is locked&#39;</span> <span style="color:#f92672">%</span> path
</span></span><span style="display:flex;"><span>        print info[<span style="color:#e6db74">&#39;lock&#39;</span>][<span style="color:#e6db74">&#39;comment&#39;</span>]</span></span></code></pre></div>
<p>Method 2:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>all_status <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>status( path, recurse<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, update<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span> )
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> status <span style="color:#f92672">in</span> all_status:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> status<span style="color:#f92672">.</span>entry <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> status<span style="color:#f92672">.</span>entry<span style="color:#f92672">.</span>lock_token <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            print <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> is locked&#39;</span> <span style="color:#f92672">%</span> status<span style="color:#f92672">.</span>path</span></span></code></pre></div>

        </p>
    </div>
    

    

    <div class="page-footer">
        
    </div>


        

<link rel="stylesheet" type="text/css" href="/css/katex.min.css" crossorigin="anonymous">
<script type="text/javascript" src="/js/katex.min.js" crossorigin="anonymous"></script>
<script type="text/javascript" src="/js/auto-render.min.js"onload="renderMathInElement(document.body);" crossorigin="anonymous"></script>

        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        

    

    
    <a class="social-icon" href="https://twitter.com/smallfishxy" target="_blank" rel="noopener" title="Twitter">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M8.991284,24.971612 C19.180436,24.971612 24.752372,16.530224 24.752372,9.210524 C24.752372,8.970656 24.747512,8.731868 24.736496,8.494376 C25.818008,7.712564 26.758256,6.737 27.5,5.62622 C26.507372,6.067076 25.439252,6.364292 24.318752,6.498212 C25.462472,5.812628 26.340512,4.727444 26.754584,3.434036 C25.684088,4.068536 24.499004,4.53002 23.23724,4.778528 C22.226468,3.701876 20.786828,3.028388 19.193828,3.028388 C16.134404,3.028388 13.653536,5.509256 13.653536,8.567492 C13.653536,9.0023 13.702244,9.424904 13.797176,9.830552 C9.19346,9.599108 5.11106,7.39472 2.3792,4.04294 C1.903028,4.861364 1.629032,5.812628 1.629032,6.827072 C1.629032,8.74904 2.606972,10.445612 4.094024,11.438132 C3.185528,11.41016 2.331788,11.160464 1.585184,10.745096 C1.583888,10.768208 1.583888,10.791428 1.583888,10.815728 C1.583888,13.49888 3.493652,15.738584 6.028088,16.246508 C5.562932,16.373084 5.07326,16.44134 4.56782,16.44134 C4.210988,16.44134 3.863876,16.406024 3.526484,16.34144 C4.231724,18.542264 6.276596,20.143796 8.701412,20.18894 C6.805148,21.674696 4.416836,22.56008 1.821488,22.56008 C1.374476,22.56008 0.93362,22.534592 0.5,22.4834 C2.951708,24.054476 5.862524,24.971612 8.991284,24.971612"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/smallfish" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

    

    

    

</div>




	<div class="footer-mobile-links">
        <p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
		<span class="divider-bar">|</span>
        <p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>
	</div>

	<script src="/js/main.min.a7205ef73b078c8daed6fe1b0826e8ba229ffabbb69d299d9446cf41f2c7d8aa.js" integrity="sha256-pyBe9zsHjI2u1v4bCCbouiKf+ru2nSmdlEbPQfLH2Ko=" crossorigin="anonymous"></script>
</footer>

    </body>
</html>